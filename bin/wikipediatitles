#!/usr/bin/perl -w
#
# wikipediatitles:
# Extract titles from the Wikipedia XML dump.
#
# Copyright (c) 2005 UK Citizens Online Democracy. All rights reserved.
# Email: chris@mysociety.org; WWW: http://www.mysociety.org/
#

my $rcsid = ''; $rcsid .= '$Id: wikipediatitles,v 1.1 2005-09-13 23:58:49 chris Exp $';

use strict;

use IO::Handle;
use XML::Parser;

binmode(STDIN, ':bytes');

my $in_title = 0;
my $title = '';

my $x = new XML::Parser(
            Style => 'Stream',
            Handlers => {
                Start => sub ($$%) {
                    my ($x, $tag, %h) = @_;
                    $in_title = 1 if ($tag eq 'title');
                },
                Char => sub ($$) {
                    my ($x, $str) = @_;
                    $title .= $str if ($in_title);
                },
                End => sub ($$) {
                    my ($x, $tag) = @_;
                    if ($tag eq 'title') {
                        $in_title = 0;
                        print "$title\n";
                        $title = '';
                    }
                }
        });

$x->parse(\*STDIN, ProtocolEncoding => 'UTF-16');

